<div class="container mt-4">
  <h1>Products</h1>

  <div class="row">
    <% @products.each do |product| %>
      <div class="col-md-4 mb-4">
        <div class="card h-100"> <%# Use h-100 for consistent card height %>
          <img src="https://picsum.photos/seed/<%= product.id %>/300/200" class="card-img-top" alt="<%= product.name %> placeholder">
          <div class="card-body d-flex flex-column"> <%# Use flexbox for footer alignment %>
            <h5 class="card-title"><%= link_to product.name, product_path(product) %></h5>
            <p class="card-text flex-grow-1"><%= truncate(product.description, length: 80) %></p> <%# flex-grow-1 pushes footer down %>
            <div class="mt-auto"> <%# Footer div %>
              <p class="card-text"><strong>Price:</strong> <%= number_to_currency(product.price) %></p>
              <%= link_to "View Details", product_path(product), class: "btn btn-primary me-2" %>
              <% if user_signed_in? %>
                <%= button_to "Add to Cart", product_cart_items_path(product), method: :post, class: "btn btn-success btn-sm d-inline-block" %> <%# d-inline-block for alignment %>
              <% end %>
            </div>
          </div>
        </div>
      </div>
    <% end %>
  </div>
</div>
